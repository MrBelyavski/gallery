(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const g of s.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&r(g)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const v="https://api.unsplash.com",I="vFVcBSszf2-iJ4lepmHIKlNbl0ysiTpmAm_2ip9R2UA",y=12;async function B(e="",t=1){let n="";e?n=`${v}/search/photos?query=${encodeURIComponent(e)}&per_page=${y}&page=${t}&client_id=${I}`:n=`${v}/photos?per_page=${y}&page=${t}&client_id=${I}`;try{const r=await fetch(n);if(!r.ok)throw new Error(`Ошибка загрузки: ${r.status} ${r.statusText}`);const o=await r.json();return e?o.results:o}catch(r){throw console.error("Ошибка при загрузке изображений:",r),r}}const M=2,w=30,F=/^[A-Za-zА-Яа-яЁё0-9\s!$&*\-=\^`|~#%'+\/?_{}]+$/;function H(e){const t=e.trim();return t.length<M?{valid:!1,message:`Минимальное количество символов: ${M}`}:t.length>w?{valid:!1,message:`Максимальное количество символов: ${w}`}:F.test(t)?{valid:!0}:{valid:!1,message:"Введены недопустимые символы. Разрешены спецсимволы: ! $ & * - = ^ ` | ~ # % ' + / ? _ { }"}}const E=document.querySelector(".gallery-grid"),f=document.querySelector(".gallery-status"),a=document.querySelector(".gallery-more"),m=document.querySelector(".gallery-loader"),A=document.querySelector(".search form"),N=A.querySelector(".search-input"),D=A.querySelector(".search-error"),h={LOAD_ERROR:"Ошибка загрузки изображений",NOT_FOUND:"Изображения не найдены",IMAGE_ERROR:"Изображение не загрузилось"};let i=1,u="",p=!1,d=!1;function C(e){f&&(f.textContent=e)}function Y(){f&&(f.textContent="")}function V(){a&&(a.style.display="")}function L(){a&&(a.style.display="none")}function z(){D.textContent=""}function K(e){D.textContent=e}function X(e){const t=document.createElement("img");return t.src=e.urls.small,t.alt=e.alt_description,t.loading="lazy",t.onerror=()=>{const n=document.createElement("div");n.textContent=h.IMAGE_ERROR,n.className="image-error",t.replaceWith(n)},t}async function j(e,t){return B(e,t)}function J(e,t=!1){t||(E.textContent=""),e.forEach(n=>{const r=X(n);E.appendChild(r)})}function Q(e){e===y?(V(),p=!1):(L(),p=!0)}function W(){m&&(m.style.display="")}function Z(){m&&(m.style.display="none")}async function S(e="",t=1,n=!1){if(!d){d=!0,W();try{n||(E.textContent="");const r=await j(e,t);if(!n&&r.length===0){C(h.NOT_FOUND),L();return}Y(),J(r,n),Q(r.length)}catch{C(h.LOAD_ERROR),L()}finally{Z(),d=!1}}}function ee(e){e.preventDefault(),z();const t=N.value,n=H(t);if(!n.valid){K(n.message),N.focus();return}u=t.trim(),i=1,S(u,i)}function te(){p||d||(i+=1,S(u,i,!0))}window.onload=()=>{i=1,u="",S(u,i)};A.addEventListener("submit",ee);a.addEventListener("click",te);const R=document.querySelector(".modal"),$=document.querySelector(".modal-image"),q=document.querySelector(".modal-overlay"),x=document.querySelector(".modal-close"),P=document.querySelector(".modal-prev"),T=document.querySelector(".modal-next"),G=document.querySelector(".gallery-grid"),b=document.getElementById("gallery");let c=[],l=0;function ne(){c=Array.from(G.querySelectorAll("img"))}function oe(e){ne(),l=c.indexOf(e),O(l),R.classList.add("open"),b.setAttribute("inert",""),document.body.style.overflow="hidden"}function _(){R.classList.remove("open"),b.removeAttribute("inert"),document.body.style.overflow=""}function O(e){if(!c.length)return;l=(e+c.length)%c.length;const t=c[l];$.src=t.src,$.alt=t.alt}function U(){O(l-1)}function k(){O(l+1)}G.addEventListener("click",e=>{e.target.tagName==="IMG"&&oe(e.target)});q&&q.addEventListener("click",_);x&&x.addEventListener("click",_);P&&P.addEventListener("click",U);T&&T.addEventListener("click",k);document.addEventListener("keydown",e=>{R.classList.contains("open")&&(e.key==="ArrowLeft"&&U(),e.key==="ArrowRight"&&k(),e.key==="Escape"&&_())});
